# Configuration for Pattern Extraction from Cloud Resources
# This file defines patterns to extract various information from cloud resources

extractionPatterns:
  osType:
    ubuntu:
      name: "Ubuntu"
      versions: ["16.04", "18.04", "20.04", "22.04", "22.10", "23.10", "23.04", "24.04", "24.10", "25.04"]
      defaultVersion: ""
      patterns: ["ubuntu", "canonical"]
      
      # Rules for identifying basic OS images
      # Basic images are clean, official OS installations without additional software or customization
      basicImageRules:
        # Common rules applied to all CSPs by default
        # Used as fallback when CSP-specific rules are not defined or empty
        common:
          include:
            - "Ubuntu * 64 bit"
            - "ubuntu/images/*"
            - "0001-com-ubuntu-server*"
            - "Canonical, Ubuntu, * LTS Minimal*"
            - "Canonical:ubuntu*server*"
            - "Ubuntu Linux * LTS*"
            - "ubuntu-*-64bit-*"
            - "ubuntu-*-base (Hypervisor:KVM)"
            - "Ubuntu Server * LTS (*)"
            - "Ubuntu Server * LTS 64bit"
            - "ubuntu-*-base"
          exclude:
            - "*marketplace*"
            - "*custom*"
            - "*test*"
            - "*dev*"
            - "*gpusvr*"
        
        # CSP-specific rules override common rules independently
        # - If include is defined and not empty → use CSP-specific include (ignore common include)
        # - If include is empty or omitted → use common include
        # - If exclude is defined and not empty → use CSP-specific exclude (ignore common exclude)
        # - If exclude is empty or omitted → use common exclude
        cspSpecific:
          azure:
            include:
              - "0001-com-ubuntu-server*gen2"
            exclude:
              - "dcassociatesgroupinc:*"  # Third-party vendor
              - "*marketplace*"
              - "*daily*"
          # Add more CSP-specific rules as needed
          # aws:
          #   include:
          #     - "ubuntu/images/hvm-ssd/*"
          #   exclude:
          #     - "*community*"
          # gcp:
          #   include:
          #     - "ubuntu-*-amd64"
          #   exclude:
          #     - "*custom*"
    centos:
      name: "CentOS"
      versions: ["7", "8", "9"]
      defaultVersion: ""
      patterns: ["centos", "centoscore"]
    debian:
      name: "Debian"
      versions: ["9", "10", "11", "12"]
      defaultVersion: ""
      patterns: ["debian"]
    windows:
      name: "Windows"
      versions: ["2016", "2019", "2022", "10", "11"]
      defaultVersion: ""
      patterns: ["windows", "win"]
    rhel:
      name: "Red Hat Enterprise Linux"
      versions: ["7", "8", "9"]
      defaultVersion: ""
      patterns: ["rhel", "red hat", "redhat"]
    amazonlinux:
      name: "Amazon Linux"
      versions: ["2", "2023"]
      defaultVersion: ""
      patterns: ["amazon linux", "amzn", "al20", "aws-marketplace", "amazon", "aws linux"]
    azurelinux:
      name: "Azure Linux"
      versions: ["2", "3"]
      defaultVersion: ""
      patterns: ["azurelinux", "azure linux"]
    fedora:
      name: "Fedora"
      versions: ["35", "36", "37", "38", "39"]
      defaultVersion: ""
      patterns: ["fedora"]
    suse:
      name: "SUSE Linux Enterprise Server"
      versions: ["12", "15"]
      defaultVersion: ""
      patterns: ["suse", "sles", "sles-sap"]
    rocky:
      name: "Rocky Linux"
      versions: ["8", "9"]
      defaultVersion: ""
      patterns: ["rocky"]
    oracle:
      name: "Oracle Linux"
      versions: ["7", "8", "9"]
      defaultVersion: "9"
      patterns: ["oracle"]
    alma:
      name: "AlmaLinux"
      versions: ["8", "9"]
      defaultVersion: ""
      patterns: ["alma"]
    alibaba:
      name: "Alibaba Cloud Linux"
      versions: ["2", "3"]
      defaultVersion: ""
      patterns: ["aliyun", "alibaba linux"]
    tencent:
      name: "Tencent Linux"
      versions: ["2", "3"]
      defaultVersion: ""
      patterns: ["tlinux", "tencentos"]
    
  # GPU image identification patterns (case-insensitive, any match = GPU)
  gpuPatterns:
    - "gpu"
    - "cuda"
    - "nvidia"
    - "deep learning"
    - "tensorflow"
    - "pytorch"
    - "keras"
    - "caffe"
    - "machine learning"
    - "optimized-for-ml"
  
  # Kubernetes image identification patterns (case-insensitive, any match = Kubernetes)
  k8sPatterns:
    # General terms
    - "kubernetes"
    - "k8s"
    # Removed "container" - too broad, causes false positives
    
    # CSP-specific terms
    - "eks"                # AWS Elastic Kubernetes Service
    - "amazon-eks"         # AWS EKS (full name in AMI)
    - "eks-optimized"      # AWS
    - "aks"                # Azure Kubernetes Service
    - "azurek8s"           # Azure
    - "gke"                # Google Kubernetes Engine
    - "cos-stable"         # GCP Container-Optimized OS (more specific than "cos")
    - "cos-cloud"          # GCP
    - "container-optimized" # GCP
    - "ack"                # Alibaba Cloud Container Service for Kubernetes
    - "aliyun-linux-k8s"   # Alibaba Cloud
    - "tke"                # Tencent Kubernetes Engine
    - "nks"                # NHN Cloud, NCP Kubernetes Service
    - "iks"                # IBM Kubernetes Service
    
    # K8s-dedicated/optimized OS distributions
    - "bottlerocket-aws-k8s"  # AWS Bottlerocket for Kubernetes (excludes ECS)
    - "flatcar"            # Flatcar Container Linux
    - "talos"              # Talos Linux (K8s-specific OS)
    